{% extends 'home/basic.html' %}
{% block title %} iStack | {{lists.0.name}} {% endblock title %}

{% block style %}
<style>
    .screenshotdiv {
        padding: 0%;
        /* padding-bottom: 15px; */
        width: 490px;
        margin: 0px 5px;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 0 3px rgb(34, 130, 141);
    }

    /* .screenshotdiv img{
        pointer-events: none;

    } */
    .mainhome {
        overflow: hidden;
    }
</style>
{% endblock %}

{% block content %}


<div class="row my-3 mx-0" style="width:100%;">

    <div class="col-md-3 shadow-lg"
        style="position: relative;color:rgb(206, 206, 206);width: 32%;background-color: rgba(46,46,46,255);height: 86vh;border-radius: 6px; overflow-y: scroll;">

        <div style="width:90px;height:90px;margin: 20px auto;background-color: transparent;">
            <img src="/media/{{lists.0.icon}}" style="width:100%;height:100%;" alt="" id="appicon">
        </div>

        <h4 id="apptitle" style="text-align:center;">{{lists.0.name|title}} {{lists.0.version}}</h4>


        <div style="text-align:center;">
            <br>
            <a style="text-align:center;" href="#">App Inc</a>
            <br><br><br>
            <form id="idform" method="post" accept="#">
                {% csrf_token %}
                <input type="hidden" value="http://localhost:8000/home/one/{{lists.0.id}}" name="appid" id="appid">
                <input type="hidden" value="http://localhost:8000{{lists.0.file.url}}" name="appexe" id="appexeid">
                <div class="spinner">
                    {% if lists.0.update %}
                    <button type="submit" id="submitbtn" class="btn btn-primary" style="width:130px;">
                        Update Now
                    </button>
                    {% else %}
                    {% if lists.0.instapos %}
                    <button type="submit" id="submitbtn" disabled class="btn btn-primary" style="width:130px;">
                        Installed
                    </button>
                    {% else %}
                    <button type="submit" id="submitbtn" class="btn btn-primary" style="width:130px;">
                        Install
                    </button>
                    {% endif %}
                    {% endif %}

                    <button id="loadingbtn" class="btn btn-primary" type="button" disabled>
                        <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
                        Loading...
                    </button>
                    <div class="progress" style="width:50%;margin:auto">
                        <div class="progress-bar " id="downloadprocessvalue" role="progressbar" style="width: 75%;"
                            aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">75%</div>
                    </div>
                </div>

            </form>
        </div>

        <div class="row my-5" style="justify-content:center;">
            <div class="col-md-3 mx-1">
                <h5>{{lists.0.average}} <i style="color:yellow;" class="bi bi-star-fill"></i></h5>
                <p>Average</p>

            </div>
            <div class="col-md-3" style="width:1px;height:60px;border-left: 1px solid gray;"></div>
            <div class="col-md-3 px-3 mx-1">

                <h5>{{lists.0.rating}}</h5>
                <p>Rating</p>
                
            </div>

        </div>
        <div class="row my-0" style="position: absolute;bottom: 0%;width: 96%;left:5.5%;text-align: center;">
            <h6>Make friend by share this app with other people and devices</h6>
            <div class="row"
                style="background-color:rgba(31, 31, 31, 0.639);padding:2px 4px;width:100%;margin:0px;font-size:20px;border-radius:4px;">
                <div class="col-md-3"><a id="facebookshare" href="#" target='_'><i class="bi bi-facebook"></i></a></div>
                <div class="col-md-3"><a id="whatsappshare"  href="#"
                        data-action="share/whatsapp/share" title="Share link by WhatsApp"><i
                            class="bi bi-whatsapp"></i></a></div>
                <div class="col-md-3"><a href="#"><i class="bi bi-bluetooth"></i></a></div>
                <div class="col-md-3"><a class="sharebtn" href="#"><i class="bi bi-share"></i></a></div>
            </div>
            <p style="font-size:15px;" class="result"></p>

        </div>



    </div>


    <div class="col-md-3 shadow-lg " style="color:red;width: 66%;height: 90vh;margin-left: 1.5%;overflow: scroll;">

        <div class="row  text-light shadow-lg py-2" style=" border-radius:6px ;background-color:rgba(46,46,46,255);">

            <h6 style="border-bottom:1px solid gray;padding-bottom:6px;">Screenshots</h6>
            <div class="row "
                style="padding-bottom:8px;display:flex;flex-direction:row;width: 1440px;height:100%;flex-wrap:nowrap;overflow-x:scroll;margin: auto;overflow-y:hidden ;">
                <div class="col-md-1 screenshotdiv ">
                    <div>
                        <img style="width:100%;width: 100%;height: 100%;" src="/media/{{lists.0.screenshots1}}" alt="">
                    </div>
                </div>
                <div class="col-md-1 screenshotdiv">
                    <div>
                        <img style="width:100%;width: 100%;height: 100%;" src="/media/{{lists.0.screenshots2}}" alt="">
                    </div>
                </div>
                <div class="col-md-1 screenshotdiv">
                    <div>
                        <img style="width:100%;width: 100%;height: 100%;" src="/media/{{lists.0.screenshots3}}" alt="">
                    </div>
                </div>
                <div class="col-md-1 screenshotdiv">
                    <div>
                        <img style="width:100%;width: 100%;height: 100%;" src="/media/{{lists.0.screenshots4}}" alt="">
                    </div>
                </div>
                <div class="col-md-1 screenshotdiv">
                    <div>
                        <img style="width:100%;width: 100%;height: 100%;" src="/media/{{lists.0.screenshots5}}" alt="">
                    </div>
                </div>
            </div>
        </div>


        <div class="row my-3 text-light my-2 shadow-lg py-2"
            style="border-radius:6px ;background-color:rgba(46,46,46,255);">

            <div style="margin:auto;">


                <h6 style="border-bottom:1px solid gray;padding-bottom:6px;">Description</h6>

                <pre>{{lists.0.descriptions}}</pre>
            </div>
        </div>


        <div class="row my-3 text-light my-2 shadow-lg py-2"
            style="border-radius:6px ;background-color:rgba(46,46,46,255);">

            <div style="margin:auto;" class="additionalinfo">


                <h6 style="border-bottom:1px solid gray;padding-bottom:6px;">Additional information</h6>

                <div class="row " style="justify-content: center;">

                    <div class="col-md-3  ">
                        <div class="row">
                            <div class="col-md-2 colspan-2">
                                <h4>

                                    <i class="bi bi-award"></i>
                                </h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>Published by</h5>
                                <p> <a href="#">{{lists.0.publisher|title}}</a> </p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3 ">
                        <div class="row">
                            <div class="col-md-2 colspan-2 ">
                                <h4><i class="bi bi-calendar-week"></i></h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>Release Date</h5>
                                <p>{{lists.0.reldate}}</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3 ">
                        <div class="row">
                            <div class="col-md-2 colspan-2 ">
                                <h4>

                                    <i class="bi bi-bookmarks"></i>
                                </h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>Category</h5>
                                <p><a href="#">{{lists.0.category|title}}</a></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row" style="justify-content: center;">
                    <div class="col-md-3 ">
                        <div class="row">
                            <div class="col-md-2 colspan-2 ">
                                <h4>

                                    <i class="bi bi-textarea-resize"></i>
                                </h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>Aproximate size</h5>
                                <p>{{lists.0.size}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 ">
                        <div class="row">
                            <div class="col-md-2 colspan-2 ">
                                <h4>

                                    <i class="bi bi-boombox"></i>
                                </h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>Installation</h5>
                                <p>{{lists.0.installation|title}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 ">
                        <div class="row">
                            <div class="col-md-2 colspan-2 ">
                                <h4>

                                    <i class="bi bi-boxes"></i>
                                </h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>This app can</h5>
                                <p>{{lists.0.info|title}}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row" style="justify-content: center;">
                    <div class="col-md-3 ">
                        <div class="row">
                            <div class="col-md-2 colspan-2 ">
                                <h4>

                                    <i class="bi bi-translate"></i>
                                </h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>Suppoted Language</h5>
                                <p>{{lists.0.language|title}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 ">
                        <div class="row">
                            <div class="col-md-2 colspan-2 ">
                                <h4>

                                    <i class="bi bi-info-square"></i>
                                </h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>publisher info</h5>
                                <p>{{lists.0.pubinfo}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 ">
                        <div class="row">
                            <div class="col-md-2 colspan-2 ">
                                <h4>
                                    <i class="bi bi-stopwatch"></i>
                                </h4>
                            </div>
                            <div class="col-md-2 ">
                                <h5>Additional Term</h5>
                                <p>{{lists.0.term|title}} </p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="row my-3 text-light my-2 shadow-lg py-2"
            style="border-radius:6px ;background-color:rgba(46,46,46,255);">

            <div style="margin:auto;">


                <h6 style="border-bottom:1px solid gray;padding-bottom:6px;">People also view</h6>

                <div class="row row-cols-1 row-cols-md-6 g-4" style="margin:auto;justify-content: center;">


                    {% for item in alldata %}

                    <div class="col py-2"
                        style="width:160px;background-color:rgb(60, 60, 60);border-radius:6px;margin:4px auto;">
                        <a href="/home/one/{{item.id}}" class="hovereffect "
                            style="background-color:rgb(218, 23, 23);text-decoration: none;;">
                            <div>
                                <img src="/media/{{item.icon}}"
                                    style="width:90px;border-radius: 10%;height:90px;margin: 8px 30px;background-color: transparent;"
                                    alt="...">
                                <h6 class="card-title" style="color:white;">{{item.name|title}}</h6>
                                <div class="card-body my-3">

                                    <div class="card-text " style="color:white;">Rating: {{item.rating}} <i
                                            style="color:yellow;" class="bi bi-star-fill"></i></div>
                                    <div class="card-text" style="color:white;">version: {{item.version}}</div>
                                </div>
                                <div class="card-text" style="color:white;"> <span
                                        style="padding:2px 5px;background-color:rgb(36, 36, 36);border-radius: 3px;">Free</span>
                                    :
                                    <span>{{item.position|title}}</span>
                                </div>
                            </div>
                        </a>
                    </div>


                    {% endfor %}
                </div>

            </div>
        </div>

    </div>
</div>


{% endblock content %}

{% block js %}
<script src="https://code.jquery.com/jquery-2.2.4.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI="
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>



<!-- <script type="text/javascript" >
    eel.expose(jsDownloadFile)
    function jsDownloadFile(pr) {
        $('.progress').show();

        let process = document.getElementById('downloadprocessvalue');
        process.style.width = pr;
        process.innerHTML = `${pr}%`; 
        console.log(pr)
    }
</script> -->

<script type="text/javascript">
    $('#loadingbtn').hide();
    $('.progress').hide();

    document.getElementById('whatsappshare').href = `whatsapp://send?text= iStack Store for windows application installatoin \n App  : ${document.getElementById('apptitle').innerHTML}  \n link: ${document.getElementById('appexeid').value}`
    document.getElementById('facebookshare').href = `https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fparse.com`

    
    $('#idform').submit(function (envet) {
        $('#submitbtn').hide()
        $('#loadingbtn').show();

        // $('#appid').empty();
        let formData = {
            appid: $('input[name=appid]').val(),
            appexe: $('input[name=appexe]').val(),

            csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
        }
        $.ajax({
            type: 'POST',
            url: '/home/one/download',
            data: formData,
            encode: true,
        })
            .done(function (data) {
                console.log(data);

            });
        envet.preventDefault();

    });

    const btn = document.querySelector('.sharebtn');
    const resultPara = document.querySelector('.result');

    // Share must be triggered by "user activation"
    btn.addEventListener('click', async () => {
        const selectedFile = document.getElementById('appexeid').files;

        console.log(selectedFile)
        const shareData = {
            title: 'iStack Store',
            text: 'Share this app to your friends and tell him how to use iStock Store',
            url: document.getElementById("appexeid").value,
            file: selectedFile
        }

        try {
            await navigator.share(shareData);
            resultPara.textContent = `${document.getElementById('apptitle').innerHTML} is Sharing....`;
        } catch (err) {
            resultPara.textContent = `Error: ${err}`;
        }
    });

</script>

{% endblock js %}